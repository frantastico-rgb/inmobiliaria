services:
  # Servicio para la Base de Datos (MariaDB - Usando 'pserv')
  - type: pserv # Tipo de servicio que Render acepta para el Private Service
    name: inmobiliaria-db
    env: mariadb # Especificamos el motor de DB
    plan: free 
    # ❌ CORRECCIÓN CLAVE: Se elimina 'database: inmobil' para evitar el error.
    #    Render usará el nombre de DB por defecto.
    
  # Servicio para la Aplicación Web (PHP + Apache Dockerizado)
  - type: web
    name: inmobiliaria-web
    env: docker
    dockerfilePath: ./Dockerfile
    
    envVars:
      # Referencias al servicio 'pserv'
      - key: DB_HOST
        fromService:
          type: pserv 
          name: inmobiliaria-db
          property: host
      - key: DB_USER
        fromService:
          type: pserv 
          name: inmobiliaria-db
          property: user
      - key: DB_PASSWORD
        fromService:
          type: pserv 
          name: inmobiliaria-db
          property: password
      - key: DB_NAME
        fromService:
          type: pserv 
          name: inmobiliaria-db
          # ✅ CORRECCIÓN FINAL: Usamos 'database' para OBTENER el nombre
          #    que Render generó para la DB.
          property: database

    # Disco persistente (disk: en singular es correcto)
    disk:
        name: uploads-data
        mountPath: /var/www/html/uploads
        sizeGB: 1