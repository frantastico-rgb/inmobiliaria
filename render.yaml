services:
  # Servicio para la Base de Datos (SQL Administrada)
  - type: database # CORRECCIÓN: Usar el tipo genérico 'database'
    name: inmobiliaria-db
    plan: free 
    database: inmobil # El nombre de la DB que Render creará
    
  # Servicio para la Aplicación Web (PHP + Apache Dockerizado)
  - type: web
    name: inmobiliaria-web
    env: docker
    dockerfilePath: ./Dockerfile
    # 'port: 80' se elimina permanentemente. Render lo maneja.
    
    envVars:
      # Las referencias deben apuntar al nuevo tipo genérico 'database'
      - key: DB_HOST
        fromService:
          type: database # CORRECCIÓN: Referencia a 'database'
          name: inmobiliaria-db
          property: host
      - key: DB_USER
        fromService:
          type: database # CORRECCIÓN: Referencia a 'database'
          name: inmobiliaria-db
          property: user
      - key: DB_PASSWORD
        fromService:
          type: database # CORRECCIÓN: Referencia a 'database'
          name: inmobiliaria-db
          property: password
      - key: DB_NAME
        fromService:
          type: database # CORRECCIÓN: Referencia a 'database'
          name: inmobiliaria-db
          property: database

    # Disco persistente (disk: en singular es correcto)
    disk:
      - name: uploads-data
        mountPath: /var/www/html/uploads
        sizeGB: 1