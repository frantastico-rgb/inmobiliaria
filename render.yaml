services:
  # Servicio para la Base de Datos (MariaDB)
  - type: mariadb # CORRECCIÓN: Usar 'mariadb' en lugar de 'pserv'
    name: inmobiliaria-db
    plan: free 
    # Propiedad correcta para el nombre de la DB. Render la creará con este nombre.
    database: inmobil 
    
  # Servicio para la Aplicación Web (PHP + Apache)
  - type: web
    name: inmobiliaria-web
    env: docker
    dockerfilePath: ./Dockerfile
    # CORRECCIÓN: Se elimina 'port: 80' para evitar el error 'field port not found'.
    
    envVars:
      - key: DB_HOST
        fromService:
          type: mariadb # CORRECCIÓN: Referencia actualizada al tipo 'mariadb'
          name: inmobiliaria-db
          property: host
      - key: DB_USER
        fromService:
          type: mariadb # CORRECCIÓN: Referencia actualizada al tipo 'mariadb'
          name: inmobiliaria-db
          property: user
      - key: DB_PASSWORD
        fromService:
          type: mariadb # CORRECCIÓN: Referencia actualizada al tipo 'mariadb'
          name: inmobiliaria-db
          property: password
      - key: DB_NAME
        fromService:
          type: mariadb # CORRECCIÓN: Referencia actualizada al tipo 'mariadb'
          name: inmobiliaria-db
          property: database # Nombre de la DB: 'inmobil'

    # Disco persistente (disk: en singular es CORRECTO y evita el error 'field disks not found')
    disk:
      - name: uploads-data
        mountPath: /var/www/html/uploads
        sizeGB: 1