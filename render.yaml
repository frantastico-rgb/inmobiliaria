services:
  # Servicio para la Base de Datos (MariaDB)
  - type: pserv
    name: inmobiliaria-db
    env: mariadb
    plan: free 
    database: inmobil # CORREGIDO: ahora es 'database'
    
  # Servicio para la Aplicación Web (PHP + Apache)
  - type: web
    name: inmobiliaria-web
    env: docker
    dockerfilePath: ./Dockerfile
    port: 80 # AGREGADO: Puerto que expone la imagen 'php:8.1-apache'
    
    envVars:
      - key: DB_HOST
        fromService:
          type: pserv
          name: inmobiliaria-db
          property: host
      - key: DB_USER
        fromService:
          type: pserv
          name: inmobiliaria-db
          property: user
      - key: DB_PASSWORD
        fromService:
          type: pserv
          name: inmobiliaria-db
          property: password
      - key: DB_NAME
        fromService:
          type: pserv
          name: inmobiliaria-db
          property: database # CORREGIDO: propiedad 'database'

    # Disco persistente para los archivos subidos (ESTÁ AL NIVEL CORRECTO)
    disks:
      - name: uploads-data
        mountPath: /var/www/html/uploads
        sizeGB: 1